2016-July-08

### Ensuring localhost access

- focus is on my Mac, but ideas are unix
    - haven't actually confirmed these work because remote web access is already disabled (cuz firewall's on?, odd vpn ips?)

- httpd.conf (systemwide)
    - change `Listen 80` to `Listen 127.0.0.1:80`
    - does not require the port to be listen in the url
    - [serverfault source](http://serverfault.com/questions/276963/make-apache-only-accessible-via-127-0-0-1-is-this-possible/276968#276968)

- single project
    - add `Require local`
        - not sure of the context - passes 'configtest' when I add it to my passenger entry:

            `<Location /url_root>`

    - [stackoverflow source](http://stackoverflow.com/a/26556483)
    - [referenced apache documentation](http://httpd.apache.org/docs/2.4/en/mod/mod_authz_host.html)

---

### mod_wsgi & passenger

- Goal: have `http://library.brown.edu/projects/usep...` urls be handled by passenger, while leaving other `http://library.brown.edu/projects...` urls to be handled by existing mod_wsgi

- Tried a bunch of things that didn't work. Hunch was that perhaps there are two separate lists of urls that apache monitors for python-handoff, and it's not clear how it decides between the two (we experimented with load-order)

- What did work: switched all `http://library.brown.edu/projects...` urls to be handled by passenger, then we could reliably control handing off to the new usep code for `projects/usep...`, while leaving the rest of `projects...` to hand off to the old projects code.

- Surprising note: the order-of-entries in the passenger-conf was _opposite_ what we expected. Here's the order that works in the passenger.conf file...

        <Location /projects>
            PassengerBaseURI /projects
            PassengerAppType wsgi
            PassengerAppRoot /path/to/projects/apache
            PassengerPython /path/to/projects_env/bin/python
        </Location>
        <Location /projects/usep>
            PassengerBaseURI /projects
            PassengerAppType wsgi
            PassengerAppRoot /path/to/usepweb_project/config
            PassengerPython /path/to/env_usepweb/bin/python
        </Location>

---

### passenger config error helper

- issue: If something's wrong in the early loading of the passenger_wsgi.py file, it can be hard to determine what the problem is. The responding web page may be blank or just say there was a problem.
    - on the Mac, underlying errors are usually displayed in an apache log, but on our devserver, they're often not (maybe due to differing passenger versions? or logging config?)

- solution: add the directive `PassengerFriendlyErrorPages on  # dev only!` in the project's `<Location /root_url>` entry.

---

[EOF]
